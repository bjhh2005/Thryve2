# Thryve2 - 智能文件处理可视化工作流编辑器
## 用户使用说明书

[![Version](https://img.shields.io/badge/version-1.0-blue.svg)](https://github.com/your-username/Thryve2)
[![PRs Welcome](https://img.shields.io/badge/PRs-welcome-brightgreen.svg)]()
[![Made with React](https://img.shields.io/badge/React-18-%2361DAFB.svg?logo=react)](https://reactjs.org/)

---

## 📋 目录

1. [项目概述](#项目概述)
2. [系统要求](#系统要求)
3. [安装与运行](#安装与运行)
4. [界面介绍](#界面介绍)
5. [功能详解](#功能详解)
6. [节点类型说明](#节点类型说明)
7. [工作流创建指南](#工作流创建指南)
8. [高级功能](#高级功能)
9. [故障排除](#故障排除)
10. [常见问题](#常见问题)

---

## 🎯 项目概述

Thryve2 是一个专为智能文件处理设计的可视化工作流编辑器。通过直观的拖拽式界面，用户可以轻松创建复杂的文件处理工作流，实现批量文件操作、格式转换、内容分析和自动化文档处理等功能。

### 核心特性

- **🎨 可视化设计器**: 拖拽式节点编辑器，直观的工作流构建体验
- **📂 智能文件处理**: 支持PDF、Word、Markdown、JSON、CSV等多种格式
- **🔄 实时执行引擎**: 实时监控工作流执行状态和结果
- **🤖 AI助手集成**: 内置AI助手支持自然语言交互
- **🔧 断点调试**: 专业级调试功能，支持条件断点和单步执行
- **🌐 跨平台应用**: 基于Electron的桌面应用，支持Windows、macOS、Linux

---

## 💻 系统要求

### 最低配置要求
- **操作系统**: Windows 10/11, macOS 10.14+, Ubuntu 18.04+
- **内存**: 4GB RAM
- **处理器**: Intel Core i3 或同等性能处理器
- **硬盘空间**: 1GB 可用空间
- **网络**: 稳定的互联网连接（用于AI功能）

### 推荐配置
- **内存**: 8GB RAM 或更高
- **处理器**: Intel Core i5 或同等性能处理器
- **硬盘空间**: 2GB 可用空间
- **显示器**: 1920x1080 或更高分辨率

---

## 🚀 安装与运行

### 1. 环境准备

#### 前端环境
```bash
# 进入前端目录
cd Fronted1

# 安装依赖
npm install

# 启动开发服务器
npm run dev
```

#### 后端环境
```bash
# 进入后端目录
cd Backend

# 安装Python依赖
pip install -r requirements.txt

# 启动后端服务
python app.py
```

### 2. 完整启动流程

1. **启动后端服务**
   ```bash
   cd Backend
   python app.py
   ```
   后端服务将在 `http://localhost:5000` 启动

2. **启动前端应用**
   ```bash
   cd Fronted1
   npm run dev
   ```
   前端应用将在 `http://localhost:3000` 启动

3. **访问应用**
   - 打开浏览器访问 `http://localhost:3000`
   - 或使用Electron桌面应用版本

### 3. 桌面应用模式

```bash
# 构建桌面应用
cd Fronted1
npm run build:electron

# 运行桌面应用
npm run electron
```

---

## 🖥️ 界面介绍

### 主界面布局

```
┌─────────────────────────────────────────────────────────────────┐
│ 🎛️ 工具栏     │ 📋 节点面板     │ 🔍 属性面板                    │
├─────────────────────────────────────────────────────────────────┤
│ 📁 项目管理   │                                                │
│ 💬 AI助手     │          🎨 画布区域                          │
│ 📊 控制台     │        (工作流编辑区)                         │
│ 🔧 调试工具   │                                                │
└─────────────────────────────────────────────────────────────────┘
```

### 界面组件详解

#### 1. 工具栏
- **文件操作**: 新建、打开、保存、导出工作流
- **编辑工具**: 撤销、重做、复制、粘贴
- **视图控制**: 缩放、居中、网格显示
- **执行控制**: 运行、暂停、停止、调试

#### 2. 节点面板
- **基础节点**: 开始、结束、打印节点
- **输入节点**: 文件输入、文件夹输入
- **处理节点**: 文本处理、图像处理、PDF处理等
- **控制节点**: 条件判断、循环、函数调用
- **AI节点**: 大语言模型、智能分析

#### 3. 画布区域
- **工作流设计**: 拖拽节点进行工作流设计
- **连接线**: 节点间的数据流连接
- **节点状态**: 实时显示节点执行状态
- **结果预览**: 查看节点输出结果

#### 4. 属性面板
- **节点配置**: 选中节点的详细配置
- **参数设置**: 输入输出参数配置
- **变量管理**: 工作流变量查看和编辑

#### 5. 左侧边栏
- **项目管理**: 工作流文件管理
- **AI助手**: 智能对话和自动化操作
- **控制台**: 执行日志和错误信息
- **调试工具**: 断点管理和执行控制

---

## 🔧 功能详解

### 1. 工作流创建

#### 基本步骤
1. **创建新工作流**: 点击"新建工作流"按钮
2. **添加起始节点**: 从节点面板拖拽"开始"节点到画布
3. **添加处理节点**: 根据需要添加文件输入、处理等节点
4. **连接节点**: 拖拽节点间的连接线建立数据流
5. **配置参数**: 在属性面板中配置各节点参数
6. **添加结束节点**: 添加"结束"节点完成工作流

#### 连接规则
- **数据流向**: 连接线表示数据流动方向
- **类型匹配**: 确保输出类型与输入类型匹配
- **端口连接**: 某些节点有多个输入/输出端口

### 2. 文件处理功能

#### 支持的文件格式
- **文档格式**: PDF, DOC, DOCX, TXT, RTF
- **数据格式**: JSON, CSV, XML, YAML
- **图像格式**: PNG, JPG, JPEG, GIF, BMP
- **标记语言**: Markdown, HTML
- **压缩格式**: ZIP, RAR, 7Z

#### 处理模式
每种处理器都支持多种模式：

**PDF处理器**
- `extract_text`: 提取文本内容
- `extract_images`: 提取图片
- `merge_pdfs`: 合并PDF文件
- `split_pdf`: 拆分PDF文件

**文本处理器**
- `read_text`: 读取文本内容
- `find_replace`: 查找替换
- `extract_keywords`: 关键词提取
- `sentiment_analysis`: 情感分析

**图像处理器**
- `resize`: 调整图像大小
- `convert_format`: 格式转换
- `add_watermark`: 添加水印
- `extract_text`: OCR文字识别

### 3. 实时执行与监控

#### 执行状态
- **🔵 等待执行**: 节点尚未开始执行
- **🟡 正在执行**: 节点正在处理中
- **🟢 执行成功**: 节点执行完成
- **🔴 执行失败**: 节点执行出错
- **⚫ 已跳过**: 节点被跳过执行

#### 监控功能
- **实时日志**: 查看详细的执行日志
- **进度跟踪**: 显示整体和单个节点的进度
- **错误报告**: 详细的错误信息和解决建议
- **性能监控**: 执行时间和内存使用情况

### 4. AI助手功能

#### 两种工作模式

**自动操作模式 (Agent Auto-operation)**
- AI自动分析工作流需求
- 自动选择合适的节点和配置
- 自动执行工作流程
- 提供执行结果和优化建议

**交互问答模式 (Ask Interactive)**
- 自然语言对话交互
- 回答工作流设计问题
- 提供使用建议和最佳实践
- 协助调试和问题解决

#### 使用方法
1. **打开AI助手**: 点击左侧边栏的AI助手图标
2. **选择模式**: 选择自动操作或交互问答模式
3. **输入需求**: 用自然语言描述您的需求
4. **AI响应**: AI会提供相应的操作或建议

---

## 📦 节点类型说明

### 基础节点

#### 🎯 开始节点 (Start)
- **功能**: 工作流的入口点
- **配置**: 可设置初始变量和参数
- **输出**: 查询字符串、启用状态等

#### 🏁 结束节点 (End)
- **功能**: 工作流的出口点
- **配置**: 可设置最终结果变量
- **输入**: 接收最终处理结果

#### 🖨️ 打印节点 (Print)
- **功能**: 输出调试信息或结果
- **配置**: 设置输出格式和内容
- **用途**: 调试、日志记录、结果展示

### 输入节点

#### 📄 文件输入节点 (File Input)
- **功能**: 选择和输入单个文件
- **支持格式**: 所有常见文件格式
- **配置**: 文件路径、变量名称、MIME类型
- **输出**: 文件路径、文件内容、元数据

#### 📁 文件夹输入节点 (Folder Input)
- **功能**: 选择文件夹并批量处理文件
- **配置**: 文件夹路径、文件过滤器、递归模式
- **输出**: 文件列表、文件夹信息
- **用途**: 批量文件处理、文件夹遍历

### 处理节点

#### 📝 文本处理器 (Text Processor)
**模式列表**:
- `read_text`: 读取文本文件内容
- `find_replace`: 查找和替换文本
- `extract_keywords`: 提取关键词
- `text_summary`: 生成文本摘要
- `word_count`: 统计词频
- `sentiment_analysis`: 情感分析

#### 🖼️ 图像处理器 (Image Processor)
**模式列表**:
- `resize`: 调整图像尺寸
- `convert_format`: 转换图像格式
- `add_watermark`: 添加水印
- `extract_text`: OCR文字识别
- `image_analysis`: 图像内容分析

#### 📋 PDF处理器 (PDF Processor)
**模式列表**:
- `extract_text`: 提取PDF文本
- `extract_images`: 提取PDF图片
- `merge_pdfs`: 合并PDF文件
- `split_pdf`: 拆分PDF文件
- `pdf_to_images`: PDF转图片

#### 📊 CSV处理器 (CSV Processor)
**模式列表**:
- `read_csv`: 读取CSV文件
- `write_csv`: 写入CSV文件
- `filter_rows`: 过滤行数据
- `aggregate_data`: 数据聚合
- `sort_data`: 数据排序

#### 📋 JSON处理器 (JSON Processor)
**模式列表**:
- `read_json`: 读取JSON文件
- `write_json`: 写入JSON文件
- `extract_fields`: 提取字段
- `transform_data`: 数据转换
- `validate_schema`: 模式验证

#### 📝 Markdown处理器 (Markdown Processor)
**模式列表**:
- `md_to_html`: Markdown转HTML
- `html_to_md`: HTML转Markdown
- `extract_headers`: 提取标题
- `extract_links`: 提取链接
- `toc_generation`: 生成目录

### 控制节点

#### 🔄 循环节点 (Loop)
- **功能**: 重复执行工作流的一部分
- **类型**: for循环、while循环、foreach循环
- **配置**: 循环条件、迭代变量、最大次数
- **用途**: 批量处理、数据遍历

#### ❓ 条件节点 (Condition)
- **功能**: 根据条件选择不同的执行路径
- **配置**: 条件表达式、比较操作
- **输出**: 多个输出端口（True/False分支）
- **用途**: 分支逻辑、条件判断

#### 📞 调用节点 (Call)
- **功能**: 调用子工作流或函数
- **配置**: 子工作流ID、传入参数
- **用途**: 模块化设计、代码复用

#### 📍 重定位节点 (Relocation)
- **功能**: 跳转到工作流的其他位置
- **配置**: 目标节点、跳转条件
- **用途**: 流程控制、异常处理

### AI节点

#### 🤖 大语言模型节点 (LLM)
- **功能**: 调用大语言模型进行文本处理
- **支持模型**: GPT、Claude、本地模型等
- **配置**: 模型选择、提示词、参数设置
- **用途**: 文本生成、内容分析、智能问答

---

## 📖 工作流创建指南

### 1. 基础工作流示例

#### 简单文件处理工作流
```
开始 → 文件输入 → 文本处理 → 打印结果 → 结束
```

**步骤**:
1. 添加开始节点
2. 添加文件输入节点，配置文件路径
3. 添加文本处理节点，选择`read_text`模式
4. 添加打印节点，显示处理结果
5. 添加结束节点

#### 批量文件处理工作流
```
开始 → 文件夹输入 → 循环节点 → 文件处理 → 结束
```

**步骤**:
1. 添加开始节点
2. 添加文件夹输入节点
3. 添加循环节点，设置遍历文件列表
4. 在循环内添加文件处理节点
5. 添加结束节点

### 2. 条件分支工作流

#### 文件格式判断处理
```
开始 → 文件输入 → 条件判断 → [PDF处理 / 图像处理] → 结束
```

**步骤**:
1. 添加开始节点
2. 添加文件输入节点
3. 添加条件节点，判断文件类型
4. 根据条件添加不同的处理节点
5. 合并分支到结束节点

### 3. 函数化工作流

#### 主工作流
```json
{
  "workflows": {
    "main_workflow": {
      "type": "main",
      "name": "主工作流",
      "nodes": [
        {
          "id": "start_1",
          "type": "start",
          "data": {
            "title": "开始"
          }
        },
        {
          "id": "call_1",
          "type": "call",
          "data": {
            "title": "调用文件处理",
            "inputsValues": {
              "subworkflow_id": {
                "type": "constant",
                "content": "file_processor"
              }
            }
          }
        },
        {
          "id": "end_1",
          "type": "end",
          "data": {
            "title": "结束"
          }
        }
      ]
    },
    "file_processor": {
      "type": "sub",
      "name": "文件处理子工作流",
      "nodes": [...]
    }
  }
}
```

### 4. 变量和数据流

#### 变量引用
```json
{
  "inputsValues": {
    "input_text": {
      "type": "ref",
      "content": ["previous_node_id", "output_variable"]
    }
  }
}
```

#### 常量值
```json
{
  "inputsValues": {
    "file_path": {
      "type": "constant",
      "content": "/path/to/file.txt"
    }
  }
}
```

---

## 🚀 高级功能

### 1. 断点调试

#### 设置断点
1. **点击节点**: 选择要调试的节点
2. **启用断点**: 点击断点按钮或使用快捷键
3. **条件断点**: 设置触发条件
4. **调试执行**: 以调试模式运行工作流

#### 调试控制
- **▶️ 继续**: 继续执行到下一个断点
- **⏭️ 单步**: 执行下一个节点
- **⏸️ 暂停**: 暂停当前执行
- **⏹️ 停止**: 停止整个工作流

#### 变量检查
- **实时变量**: 查看当前节点的变量值
- **数据流**: 追踪数据在节点间的流动
- **执行堆栈**: 查看函数调用栈

### 2. 内存管理

#### 自动内存优化
- **懒加载**: 节点按需实例化
- **自动清理**: 子工作流完成后自动清理
- **内存监控**: 实时监控内存使用情况

#### 内存使用查询
```bash
# 查看内存使用情况
GET /api/workflows/memory

# 查看特定工作流内存
GET /api/workflows/{workflow_id}/memory
```

### 3. 模板系统

#### 使用预设模板
1. **选择模板**: 从模板库选择合适的模板
2. **导入模板**: 将模板导入到当前工作流
3. **自定义修改**: 根据需要修改模板
4. **保存为模板**: 将自定义工作流保存为模板

#### 常用模板
- **文档转换**: PDF转Word、Markdown转HTML等
- **批量处理**: 批量文件重命名、格式转换
- **数据提取**: 从文档中提取特定信息
- **内容分析**: 文本分析、关键词提取

### 4. 协作功能

#### 工作流分享
1. **导出工作流**: 将工作流导出为JSON文件
2. **分享链接**: 生成可分享的工作流链接
3. **导入工作流**: 从文件或链接导入工作流
4. **版本管理**: 管理工作流的不同版本

#### 团队协作
- **多用户编辑**: 支持多用户同时编辑工作流
- **变更追踪**: 记录所有变更历史
- **权限管理**: 控制不同用户的访问权限

---

## 🛠️ 故障排除

### 常见问题及解决方案

#### 1. 连接问题

**问题**: 前端无法连接到后端
**解决方案**:
- 确认后端服务正在运行 (http://localhost:5000)
- 检查防火墙设置
- 确认端口未被占用

#### 2. 节点执行失败

**问题**: 节点执行时出现错误
**解决方案**:
- 检查节点配置是否正确
- 确认输入数据类型匹配
- 查看错误日志获取详细信息
- 检查文件路径是否存在

#### 3. 文件处理错误

**问题**: 文件无法正常处理
**解决方案**:
- 确认文件格式支持
- 检查文件权限
- 验证文件完整性
- 检查磁盘空间

#### 4. 内存不足

**问题**: 处理大文件时内存不足
**解决方案**:
- 使用批量处理模式
- 增加系统内存
- 优化工作流设计
- 使用内存清理功能

### 调试技巧

#### 1. 使用调试模式
- 启用断点调试
- 单步执行查看问题
- 检查变量值

#### 2. 查看日志
- 控制台查看实时日志
- 分析错误信息
- 跟踪执行过程

#### 3. 简化工作流
- 删除复杂节点
- 使用简单数据测试
- 逐步添加功能

---

## ❓ 常见问题

### Q1: 如何导入已有的工作流？
**A**: 点击"文件"菜单，选择"导入工作流"，选择JSON格式的工作流文件即可导入。

### Q2: 支持哪些AI模型？
**A**: 目前支持GPT系列、Claude、以及本地部署的开源模型。具体支持情况请查看AI节点配置。

### Q3: 如何处理大文件？
**A**: 建议使用批量处理模式，分批处理大文件。同时可以启用内存优化功能减少内存占用。

### Q4: 工作流可以定时执行吗？
**A**: 可以，使用调度器节点可以设置定时执行规则。

### Q5: 如何备份工作流？
**A**: 可以将工作流导出为JSON文件进行备份，或使用内置的项目管理功能。

### Q6: 支持插件扩展吗？
**A**: 支持。可以通过编写自定义节点来扩展功能，请参考开发文档。

### Q7: 如何获得技术支持？
**A**: 可以通过以下方式获得支持：
- 查看项目文档
- 提交GitHub Issues
- 加入用户社区讨论

---

## 📚 参考资料

- [项目GitHub仓库](https://github.com/your-username/Thryve2)
- [开发文档](./README.md)
- [API文档](./API.md)
- [节点开发指南](./NODE_DEVELOPMENT.md)

---

## 📝 更新日志

### 版本 1.0.0
- 初始发布版本
- 完整的可视化工作流编辑器
- 多种文件处理节点
- AI助手集成
- 断点调试功能
- 内存管理优化

---

**© 2024 Thryve2 团队 | 保留所有权利** 